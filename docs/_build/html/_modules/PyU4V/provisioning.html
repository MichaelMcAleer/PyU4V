

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>PyU4V.provisioning &mdash; PyU4V 3.1.7 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> PyU4V
          

          
          </a>

          
            
            
              <div class="version">
                3.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quick_start.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quick_start.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools.html">Tools Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html#indices-and-tables">Indices and tables</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PyU4V</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>PyU4V.provisioning</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for PyU4V.provisioning</h1><div class="highlight"><pre>
<span></span><span class="c1"># The MIT License (MIT)</span>
<span class="c1"># Copyright (c) 2016 Dell Inc. or its subsidiaries.</span>

<span class="c1"># Permission is hereby granted, free of charge, to any person</span>
<span class="c1"># obtaining a copy of this software and associated documentation</span>
<span class="c1"># files (the &quot;Software&quot;), to deal in the Software without restriction,</span>
<span class="c1"># including without limitation the rights to use, copy, modify,</span>
<span class="c1"># merge, publish, distribute, sublicense, and/or sell copies of</span>
<span class="c1"># the Software, and to permit persons to whom the Software is</span>
<span class="c1"># furnished to do so, subject to the following conditions:</span>

<span class="c1"># The above copyright notice and this permission notice shall be</span>
<span class="c1"># included in all copies or substantial portions of the Software.</span>

<span class="c1"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,</span>
<span class="c1"># EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES</span>
<span class="c1"># OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.</span>
<span class="c1"># IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY</span>
<span class="c1"># CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,</span>
<span class="c1"># TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE</span>
<span class="c1"># SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span>
<span class="sd">&quot;&quot;&quot;provisioning.py.&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">from</span> <span class="nn">PyU4V.utils</span> <span class="k">import</span> <span class="n">constants</span>
<span class="kn">from</span> <span class="nn">PyU4V.utils</span> <span class="k">import</span> <span class="n">exception</span>

<span class="n">LOG</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">SLOPROVISIONING</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">SLOPROVISIONING</span>
<span class="n">CREATE_VOL_STRING</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">CREATE_VOL_STRING</span>
<span class="n">ASYNC_UPDATE</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">ASYNC_UPDATE</span>


<div class="viewcode-block" id="ProvisioningFunctions"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions">[docs]</a><span class="k">class</span> <span class="nc">ProvisioningFunctions</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ProvisioningFunctions.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array_id</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">common</span><span class="p">,</span> <span class="n">u4v_version</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;__init__.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span> <span class="o">=</span> <span class="n">array_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">common</span> <span class="o">=</span> <span class="n">common</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">request</span> <span class="o">=</span> <span class="n">request</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">U4V_VERSION</span> <span class="o">=</span> <span class="n">u4v_version</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">get_resource</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">create_resource</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modify_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">modify_resource</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">delete_resource</span>

<div class="viewcode-block" id="ProvisioningFunctions.get_director"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_director">[docs]</a>    <span class="k">def</span> <span class="nf">get_director</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">director</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Query for details of a director for a symmetrix.</span>

<span class="sd">        :param director: the director ID e.g. FA-1D</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U4V_VERSION</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">90</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="s1">&#39;director&#39;</span><span class="p">,</span>
                                     <span class="n">resource_name</span><span class="o">=</span><span class="n">director</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span>
                                     <span class="s1">&#39;director&#39;</span><span class="p">,</span> <span class="n">resource_name</span><span class="o">=</span><span class="n">director</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_director_list"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_director_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_director_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Query for details of Symmetrix directors for a symmetrix.</span>

<span class="sd">        :returns: director list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U4V_VERSION</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;director&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="s1">&#39;director&#39;</span><span class="p">)</span>
        <span class="n">director_list</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;directorId&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="k">if</span> <span class="n">response</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">director_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_director_port"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_director_port">[docs]</a>    <span class="k">def</span> <span class="nf">get_director_port</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">director</span><span class="p">,</span> <span class="n">port_no</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get details of the symmetrix director port.</span>

<span class="sd">        :param director: the director ID e.g. FA-1D</span>
<span class="sd">        :param port_no: the port number e.g. 1</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{director}</span><span class="s1">/port/</span><span class="si">{port_no}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">director</span><span class="o">=</span><span class="n">director</span><span class="p">,</span> <span class="n">port_no</span><span class="o">=</span><span class="n">port_no</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U4V_VERSION</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span>
                                     <span class="s1">&#39;director&#39;</span><span class="p">,</span>
                                     <span class="n">resource_name</span><span class="o">=</span><span class="n">res_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="s1">&#39;director&#39;</span><span class="p">,</span>
                                     <span class="n">resource_name</span><span class="o">=</span><span class="n">res_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_director_port_list"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_director_port_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_director_port_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">director</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get list of the ports on a particular director.</span>

<span class="sd">        Can be filtered by optional parameters, please see documentation.</span>

<span class="sd">        :param director: the director ID e.g. FA-1D</span>
<span class="sd">        :param filters: optional filters - dict</span>
<span class="sd">        :returns: list of port key dicts</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">resource_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{director}</span><span class="s1">/port&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">director</span><span class="o">=</span><span class="n">director</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U4V_VERSION</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;director&#39;</span><span class="p">,</span>
                <span class="n">resource_name</span><span class="o">=</span><span class="n">resource_name</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="s1">&#39;director&#39;</span><span class="p">,</span>
                <span class="n">resource_name</span><span class="o">=</span><span class="n">resource_name</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>

        <span class="n">port_key_list</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;symmetrixPortKey&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">response</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">port_key_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_port_identifier"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_port_identifier">[docs]</a>    <span class="k">def</span> <span class="nf">get_port_identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">director</span><span class="p">,</span> <span class="n">port_no</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the identifier (wwn) of the physical port.</span>

<span class="sd">        :param director: the ID of the director</span>
<span class="sd">        :param port_no: the number of the port</span>
<span class="sd">        :returns: wwn (FC) or iqn (iscsi), or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wwn</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">port_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_director_port</span><span class="p">(</span><span class="n">director</span><span class="p">,</span> <span class="n">port_no</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">port_info</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">wwn</span> <span class="o">=</span> <span class="n">port_info</span><span class="p">[</span><span class="s1">&#39;symmetrixPort&#39;</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">LOG</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Cannot retrieve port information&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wwn</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_host"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_host">[docs]</a>    <span class="k">def</span> <span class="nf">get_host</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get details on a host on the array.</span>

<span class="sd">        :param host_id: the name of the host, optional</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">,</span>
                                 <span class="n">resource_name</span><span class="o">=</span><span class="n">host_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_host_list"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_host_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_host_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get list of the hosts on the array.</span>

<span class="sd">        See documentation for applicable filters.</span>

<span class="sd">        :param filters: optional list of filters - dict</span>
<span class="sd">        :returns: list of hosts</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
        <span class="n">host_list</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;hostId&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="k">if</span> <span class="n">response</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">host_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.create_host"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.create_host">[docs]</a>    <span class="k">def</span> <span class="nf">create_host</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host_name</span><span class="p">,</span> <span class="n">initiator_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">host_flags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">init_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_async</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a host with the given initiators.</span>

<span class="sd">        Accepts either initiator_list, e.g.</span>
<span class="sd">        [10000000ba873cbf, 10000000ba873cba], or file.</span>
<span class="sd">        The initiators must not be associated with another host.</span>
<span class="sd">        An empty host can also be created by not passing any initiator ids.</span>

<span class="sd">        :param host_name: the name of the new host</span>
<span class="sd">        :param initiator_list: list of initiators</span>
<span class="sd">        :param host_flags: dictionary of optional host flags to apply</span>
<span class="sd">        :param init_file: full path to file that contains initiator names</span>
<span class="sd">        :param _async: Flag to indicate if call should be _async</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">init_file</span><span class="p">:</span>
            <span class="n">initiator_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">create_list_from_file</span><span class="p">(</span><span class="n">init_file</span><span class="p">)</span>
        <span class="n">new_ig_data</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;hostId&#39;</span><span class="p">:</span> <span class="n">host_name</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">initiator_list</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">initiator_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">new_ig_data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;initiatorId&#39;</span><span class="p">:</span> <span class="n">initiator_list</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">host_flags</span><span class="p">:</span>
            <span class="n">new_ig_data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;hostFlags&#39;</span><span class="p">:</span> <span class="n">host_flags</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">_async</span><span class="p">:</span>
            <span class="n">new_ig_data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ASYNC_UPDATE</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span>
                                    <span class="s1">&#39;host&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="n">new_ig_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.modify_host"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.modify_host">[docs]</a>    <span class="k">def</span> <span class="nf">modify_host</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host_id</span><span class="p">,</span> <span class="n">host_flag_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">remove_init_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add_init_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modify an existing host.</span>

<span class="sd">        Only one parameter can be modified at a time.</span>

<span class="sd">        :param host_id: the host name</span>
<span class="sd">        :param host_flag_dict: dictionary of host flags</span>
<span class="sd">        :param remove_init_list: list of initiators to be removed</span>
<span class="sd">        :param add_init_list: list of initiators to be added</span>
<span class="sd">        :param new_name: new host name</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">host_flag_dict</span><span class="p">:</span>
            <span class="n">edit_host_data</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;editHostActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;setHostFlagsParam&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;hostFlags&#39;</span><span class="p">:</span> <span class="n">host_flag_dict</span><span class="p">}}})</span>
        <span class="k">elif</span> <span class="n">remove_init_list</span><span class="p">:</span>
            <span class="n">edit_host_data</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;editHostActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;removeInitiatorParam&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;initiator&#39;</span><span class="p">:</span> <span class="n">remove_init_list</span><span class="p">}}})</span>
        <span class="k">elif</span> <span class="n">add_init_list</span><span class="p">:</span>
            <span class="n">edit_host_data</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;editHostActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;addInitiatorParam&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;initiator&#39;</span><span class="p">:</span> <span class="n">add_init_list</span><span class="p">}}})</span>
        <span class="k">elif</span> <span class="n">new_name</span><span class="p">:</span>
            <span class="n">edit_host_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;editHostActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;renameHostParam&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;new_host_name&#39;</span><span class="p">:</span> <span class="n">new_name</span><span class="p">}}}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;No modify host parameters chosen - please supply one &#39;</span>
                   <span class="s1">&#39;of the following: host_flag_dict, remove_init_list, &#39;</span>
                   <span class="s1">&#39;add_init_list, or new_name.&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">exception</span><span class="o">.</span><span class="n">InvalidInputException</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="n">edit_host_data</span><span class="p">,</span>
            <span class="n">resource_name</span><span class="o">=</span><span class="n">host_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.delete_host"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.delete_host">[docs]</a>    <span class="k">def</span> <span class="nf">delete_host</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete a given host.</span>

<span class="sd">        Cannot delete if associated with a masking view.</span>

<span class="sd">        :param host_id: name of the host</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">,</span>
                             <span class="n">resource_name</span><span class="o">=</span><span class="n">host_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_mvs_from_host"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_mvs_from_host">[docs]</a>    <span class="k">def</span> <span class="nf">get_mvs_from_host</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve masking view information for a specified host.</span>

<span class="sd">        :param host_id: the name of the host</span>
<span class="sd">        :returns: list of masking views</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mv_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">host_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_host</span><span class="p">(</span><span class="n">host_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">host_details</span> <span class="ow">and</span> <span class="n">host_details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;maskingview&#39;</span><span class="p">):</span>
            <span class="n">mv_list</span> <span class="o">=</span> <span class="n">host_details</span><span class="p">[</span><span class="s1">&#39;maskingview&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">mv_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_initiator_ids_from_host"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_initiator_ids_from_host">[docs]</a>    <span class="k">def</span> <span class="nf">get_initiator_ids_from_host</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get initiator details from a host.</span>

<span class="sd">        :param host_id: the name of the host</span>
<span class="sd">        :returns: list of initiator IDs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">initiator_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">host_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_host</span><span class="p">(</span><span class="n">host_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">host_details</span> <span class="ow">and</span> <span class="n">host_details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;initiator&#39;</span><span class="p">):</span>
            <span class="n">initiator_list</span> <span class="o">=</span> <span class="n">host_details</span><span class="p">[</span><span class="s1">&#39;initiator&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">initiator_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_hostgroup"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_hostgroup">[docs]</a>    <span class="k">def</span> <span class="nf">get_hostgroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hostgroup_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get details on a hostgroup on the array.</span>

<span class="sd">        :param hostgroup_id: the name of the hostgroup</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;hostgroup&#39;</span><span class="p">,</span>
                                 <span class="n">resource_name</span><span class="o">=</span><span class="n">hostgroup_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_hostgroup_list"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_hostgroup_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_hostgroup_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get list of hostgroup(s) on the array.</span>

<span class="sd">        See unisphere documentation for applicable filters.</span>

<span class="sd">        :param filters: optional list of filters - dict</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;hostgroup&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
        <span class="n">hostgroup_list</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;hostGroupId&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="k">if</span> <span class="n">response</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">hostgroup_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.create_hostgroup"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.create_hostgroup">[docs]</a>    <span class="k">def</span> <span class="nf">create_hostgroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hostgroup_id</span><span class="p">,</span> <span class="n">host_list</span><span class="p">,</span>
                         <span class="n">host_flags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_async</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a hostgroup containing the given hosts.</span>

<span class="sd">        :param hostgroup_id: the name of the new hostgroup</span>
<span class="sd">        :param host_list: list of hosts</span>
<span class="sd">        :param host_flags: dictionary of optional host flags to apply</span>
<span class="sd">        :param _async: Flag to indicate if call should be async</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_ig_data</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;hostId&#39;</span><span class="p">:</span> <span class="n">host_list</span><span class="p">,</span> <span class="s1">&#39;hostGroupId&#39;</span><span class="p">:</span> <span class="n">hostgroup_id</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">host_flags</span><span class="p">:</span>
            <span class="n">new_ig_data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;hostFlags&#39;</span><span class="p">:</span> <span class="n">host_flags</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">_async</span><span class="p">:</span>
            <span class="n">new_ig_data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ASYNC_UPDATE</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span>
                                    <span class="s1">&#39;hostgroup&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="n">new_ig_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.modify_hostgroup"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.modify_hostgroup">[docs]</a>    <span class="k">def</span> <span class="nf">modify_hostgroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hostgroup_id</span><span class="p">,</span> <span class="n">host_flag_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">remove_host_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add_host_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">new_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modify an existing hostgroup.</span>

<span class="sd">        Only one parameter can be modified at a time.</span>

<span class="sd">        :param hostgroup_id: the name of the hostgroup</span>
<span class="sd">        :param host_flag_dict: dictionary of host flags</span>
<span class="sd">        :param remove_host_list: list of hosts to be removed</span>
<span class="sd">        :param add_host_list: list of hosts to be added</span>
<span class="sd">        :param new_name: new name of the hostgroup</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">host_flag_dict</span><span class="p">:</span>
            <span class="n">edit_host_data</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;editHostGroupActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;setHostGroupFlagsParam&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;hostFlags&#39;</span><span class="p">:</span> <span class="n">host_flag_dict</span><span class="p">}}})</span>
        <span class="k">elif</span> <span class="n">remove_host_list</span><span class="p">:</span>
            <span class="n">edit_host_data</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;editHostGroupActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;removeHostParam&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="n">remove_host_list</span><span class="p">}}})</span>
        <span class="k">elif</span> <span class="n">add_host_list</span><span class="p">:</span>
            <span class="n">edit_host_data</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;editHostGroupActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;addHostParam&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="n">add_host_list</span><span class="p">}}})</span>
        <span class="k">elif</span> <span class="n">new_name</span><span class="p">:</span>
            <span class="n">edit_host_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;editHostGroupActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;renameHostGroupParam&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;new_host_group_name&#39;</span><span class="p">:</span> <span class="n">new_name</span><span class="p">}}}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;No modify hostgroup parameters chosen - please supply &#39;</span>
                   <span class="s1">&#39;one of the following: host_flag_dict, &#39;</span>
                   <span class="s1">&#39;remove_host_list, add_host_list, or new_name.&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">exception</span><span class="o">.</span><span class="n">InvalidInputException</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;hostgroup&#39;</span><span class="p">,</span>
            <span class="n">payload</span><span class="o">=</span><span class="n">edit_host_data</span><span class="p">,</span> <span class="n">resource_name</span><span class="o">=</span><span class="n">hostgroup_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.delete_hostgroup"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.delete_hostgroup">[docs]</a>    <span class="k">def</span> <span class="nf">delete_hostgroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hostgroup_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete a given hostgroup.</span>

<span class="sd">        Cannot delete if associated with a masking view.</span>

<span class="sd">        :param hostgroup_id: name of the hostgroup</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span>
                             <span class="s1">&#39;hostgroup&#39;</span><span class="p">,</span> <span class="n">resource_name</span><span class="o">=</span><span class="n">hostgroup_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_initiator"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_initiator">[docs]</a>    <span class="k">def</span> <span class="nf">get_initiator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initiator_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get details of an initiator.</span>

<span class="sd">        :param initiator_id: initiator id, optional</span>
<span class="sd">        :returns: initiator details</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;initiator&#39;</span><span class="p">,</span>
                                 <span class="n">resource_name</span><span class="o">=</span><span class="n">initiator_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_initiator_list"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_initiator_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_initiator_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve initiator list from the array.</span>

<span class="sd">        :param params: dict of optional params</span>
<span class="sd">        :returns: list of initiators</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;initiator&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
        <span class="n">init_list</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;initiatorId&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="k">if</span> <span class="n">response</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">init_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.modify_initiator"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.modify_initiator">[docs]</a>    <span class="k">def</span> <span class="nf">modify_initiator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initiator_id</span><span class="p">,</span> <span class="n">remove_masking_entry</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">replace_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rename_alias</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">set_fcid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initiator_flags</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modify an initiator.</span>

<span class="sd">        Only one parameter can be edited at a time.</span>

<span class="sd">        :param initiator_id: the initiator id</span>
<span class="sd">        :param remove_masking_entry: string - &quot;true&quot; or &quot;false&quot;</span>
<span class="sd">        :param replace_init: Id of the new initiator</span>
<span class="sd">        :param rename_alias: tuple (&#39;new node name&#39;, &#39;new port name&#39;)</span>
<span class="sd">        :param set_fcid: set fcid value - string</span>
<span class="sd">        :param initiator_flags: dictionary of initiator flags to set</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">remove_masking_entry</span><span class="p">:</span>
            <span class="n">edit_init_data</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;editInitiatorActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;removeMaskingEntry&#39;</span><span class="p">:</span> <span class="n">remove_masking_entry</span><span class="p">}})</span>
        <span class="k">elif</span> <span class="n">replace_init</span><span class="p">:</span>
            <span class="n">edit_init_data</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;editInitiatorActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;replaceInitiatorParam&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;new_initiator&#39;</span><span class="p">:</span> <span class="n">replace_init</span><span class="p">}}})</span>
        <span class="k">elif</span> <span class="n">rename_alias</span><span class="p">:</span>
            <span class="n">edit_init_data</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;editInitiatorActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;renameAliasParam&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;port_name&#39;</span><span class="p">:</span> <span class="n">rename_alias</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                     <span class="s1">&#39;node_name&#39;</span><span class="p">:</span> <span class="n">rename_alias</span><span class="p">[</span><span class="mi">1</span><span class="p">]}}})</span>
        <span class="k">elif</span> <span class="n">set_fcid</span><span class="p">:</span>
            <span class="n">edit_init_data</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;editInitiatorActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;initiatorSetAttributesParam&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;fcidValue&#39;</span><span class="p">:</span> <span class="n">set_fcid</span><span class="p">}}})</span>
        <span class="k">elif</span> <span class="n">initiator_flags</span><span class="p">:</span>
            <span class="n">edit_init_data</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;editInitiatorActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;initiatorSetFlagsParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;initiatorFlags&#39;</span><span class="p">:</span> <span class="n">initiator_flags</span><span class="p">}}})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;No modify initiator parameters chosen - please supply &#39;</span>
                   <span class="s1">&#39;one of the following: removeMaskingEntry, &#39;</span>
                   <span class="s1">&#39;replace_init, rename_alias, set_fcid, &#39;</span>
                   <span class="s1">&#39;initiator_flags.&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">exception</span><span class="o">.</span><span class="n">InvalidInputException</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;initiator&#39;</span><span class="p">,</span>
            <span class="n">payload</span><span class="o">=</span><span class="n">edit_init_data</span><span class="p">,</span> <span class="n">resource_name</span><span class="o">=</span><span class="n">initiator_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.is_initiator_in_host"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.is_initiator_in_host">[docs]</a>    <span class="k">def</span> <span class="nf">is_initiator_in_host</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initiator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check to see if a given initiator is already assigned to a host.</span>

<span class="sd">        :param initiator: the initiator ID</span>
<span class="sd">        :returns: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">init_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_in_use_initiator_list_from_array</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">init</span> <span class="ow">in</span> <span class="n">init_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">initiator</span> <span class="ow">in</span> <span class="n">init</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_in_use_initiator_list_from_array"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_in_use_initiator_list_from_array">[docs]</a>    <span class="k">def</span> <span class="nf">get_in_use_initiator_list_from_array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the list of initiators which are in-use from the array.</span>

<span class="sd">        Gets the list of initiators from the array which are in</span>
<span class="sd">        hosts/ initiator groups.</span>

<span class="sd">        :returns: list of in-use initiators</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;in_a_host&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_initiator_list</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_initiator_group_from_initiator"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_initiator_group_from_initiator">[docs]</a>    <span class="k">def</span> <span class="nf">get_initiator_group_from_initiator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initiator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Given an initiator, get its corresponding initiator group, if any.</span>

<span class="sd">        :param initiator: the initiator id</span>
<span class="sd">        :returns: found_init_group_name -- string, or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">init_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_initiator</span><span class="p">(</span><span class="n">initiator</span><span class="p">)</span>
        <span class="n">found_ig_name</span> <span class="o">=</span> <span class="n">init_details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;host&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">init_details</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">found_ig_name</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_masking_view_list"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_masking_view_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_masking_view_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a masking view or list of masking views.</span>

<span class="sd">        See unisphere documentation for possible filters.</span>

<span class="sd">        :param filters: dictionary of filters</span>
<span class="sd">        :returns: list of masking views</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;maskingview&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
        <span class="n">masking_view_list</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s1">&#39;maskingViewId&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="k">if</span> <span class="n">response</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">masking_view_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_masking_view"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_masking_view">[docs]</a>    <span class="k">def</span> <span class="nf">get_masking_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">masking_view_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get details of a masking view.</span>

<span class="sd">        :param masking_view_name: the masking view name</span>
<span class="sd">        :returns: masking view dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span>
            <span class="s1">&#39;maskingview&#39;</span><span class="p">,</span> <span class="n">resource_name</span><span class="o">=</span><span class="n">masking_view_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.create_masking_view_existing_components"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.create_masking_view_existing_components">[docs]</a>    <span class="k">def</span> <span class="nf">create_masking_view_existing_components</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">port_group_name</span><span class="p">,</span> <span class="n">masking_view_name</span><span class="p">,</span>
            <span class="n">storage_group_name</span><span class="p">,</span> <span class="n">host_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">host_group_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_async</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new masking view using existing groups.</span>

<span class="sd">        Must enter either a host name or a host group name, but</span>
<span class="sd">        not both.</span>

<span class="sd">        :param port_group_name: name of the port group</span>
<span class="sd">        :param masking_view_name: name of the new masking view</span>
<span class="sd">        :param storage_group_name: name of the storage group</span>
<span class="sd">        :param host_name: name of the host (initiator group)</span>
<span class="sd">        :param host_group_name: name of host group</span>
<span class="sd">        :param _async: flag to indicate if command should be run asynchronously</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        :raises: InvalidInputException</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">host_name</span><span class="p">:</span>
            <span class="n">host_details</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;useExistingHostParam&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;hostId&#39;</span><span class="p">:</span> <span class="n">host_name</span><span class="p">}}</span>
        <span class="k">elif</span> <span class="n">host_group_name</span><span class="p">:</span>
            <span class="n">host_details</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;useExistingHostGroupParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;hostGroupId&#39;</span><span class="p">:</span> <span class="n">host_group_name</span><span class="p">}}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Must enter either a host name or a host group name&#39;</span>
            <span class="k">raise</span> <span class="n">exception</span><span class="o">.</span><span class="n">InvalidInputException</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="p">({</span>
            <span class="s1">&#39;portGroupSelection&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;useExistingPortGroupParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;portGroupId&#39;</span><span class="p">:</span> <span class="n">port_group_name</span><span class="p">}},</span>
            <span class="s1">&#39;maskingViewId&#39;</span><span class="p">:</span> <span class="n">masking_view_name</span><span class="p">,</span>
            <span class="s1">&#39;hostOrHostGroupSelection&#39;</span><span class="p">:</span> <span class="n">host_details</span><span class="p">,</span>
            <span class="s1">&#39;storageGroupSelection&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;useExistingStorageGroupParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;storageGroupId&#39;</span><span class="p">:</span> <span class="n">storage_group_name</span><span class="p">}}})</span>
        <span class="k">if</span> <span class="n">_async</span><span class="p">:</span>
            <span class="n">payload</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ASYNC_UPDATE</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;maskingview&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_masking_views_from_storage_group"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_masking_views_from_storage_group">[docs]</a>    <span class="k">def</span> <span class="nf">get_masking_views_from_storage_group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storagegroup</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return any masking views associated with a storage group.</span>

<span class="sd">        :param storagegroup: the storage group name</span>
<span class="sd">        :returns: masking view list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">storagegroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_storage_group</span><span class="p">(</span><span class="n">storagegroup</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">storagegroup</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;maskingview&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="k">if</span> <span class="n">storagegroup</span> <span class="k">else</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_masking_views_by_host"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_masking_views_by_host">[docs]</a>    <span class="k">def</span> <span class="nf">get_masking_views_by_host</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initiatorgroup_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Given a host (initiator group), retrieve the masking view name.</span>

<span class="sd">        Retrieve the list of masking views associated with the</span>
<span class="sd">        given initiator group.</span>

<span class="sd">        :param initiatorgroup_name: the name of the initiator group</span>
<span class="sd">        :returns: list of masking view names</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ig_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_host</span><span class="p">(</span><span class="n">initiatorgroup_name</span><span class="p">)</span>
        <span class="n">masking_view_list</span> <span class="o">=</span> <span class="n">ig_details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s1">&#39;maskingview&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="k">if</span> <span class="n">ig_details</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">masking_view_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_element_from_masking_view"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_element_from_masking_view">[docs]</a>    <span class="k">def</span> <span class="nf">get_element_from_masking_view</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">maskingview_name</span><span class="p">,</span> <span class="n">portgroup</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">storagegroup</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the name of the specified element from a masking view.</span>

<span class="sd">        :param maskingview_name: the masking view name</span>
<span class="sd">        :param portgroup: the port group name - optional</span>
<span class="sd">        :param host: the host name - optional</span>
<span class="sd">        :param storagegroup: the storage group name - optional</span>
<span class="sd">        :returns: name of the specified element -- string</span>
<span class="sd">        :raises: ResourceNotFoundException</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">element</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">masking_view_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_masking_view</span><span class="p">(</span><span class="n">maskingview_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">masking_view_details</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">portgroup</span><span class="p">:</span>
                <span class="n">element</span> <span class="o">=</span> <span class="n">masking_view_details</span><span class="p">[</span><span class="s1">&#39;portGroupId&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">host</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">masking_view_details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;hostId&#39;</span><span class="p">):</span>
                    <span class="n">element</span> <span class="o">=</span> <span class="n">masking_view_details</span><span class="p">[</span><span class="s1">&#39;hostId&#39;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">masking_view_details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;hostGroupId&#39;</span><span class="p">):</span>
                    <span class="n">element</span> <span class="o">=</span> <span class="n">masking_view_details</span><span class="p">[</span><span class="s1">&#39;hostGroupId&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">storagegroup</span><span class="p">:</span>
                <span class="n">element</span> <span class="o">=</span> <span class="n">masking_view_details</span><span class="p">[</span><span class="s1">&#39;storageGroupId&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">exception_message</span> <span class="o">=</span> <span class="s1">&#39;Error retrieving masking group.&#39;</span>
            <span class="k">raise</span> <span class="n">exception</span><span class="o">.</span><span class="n">ResourceNotFoundException</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">element</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_common_masking_views"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_common_masking_views">[docs]</a>    <span class="k">def</span> <span class="nf">get_common_masking_views</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">portgroup_name</span><span class="p">,</span> <span class="n">ig_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get common masking views for a given portgroup and initiator group.</span>

<span class="sd">        :param portgroup_name: the port group name</span>
<span class="sd">        :param ig_name: the initiator group name</span>
<span class="sd">        :returns: masking view list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;port_group_name&#39;</span><span class="p">:</span> <span class="n">portgroup_name</span><span class="p">,</span>
                  <span class="s1">&#39;host_or_host_group_name&#39;</span><span class="p">:</span> <span class="n">ig_name</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_masking_view_list</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.delete_masking_view"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.delete_masking_view">[docs]</a>    <span class="k">def</span> <span class="nf">delete_masking_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maskingview_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete a masking view.</span>

<span class="sd">        :param maskingview_name: the masking view name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;maskingview&#39;</span><span class="p">,</span>
            <span class="n">resource_name</span><span class="o">=</span><span class="n">maskingview_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.rename_masking_view"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.rename_masking_view">[docs]</a>    <span class="k">def</span> <span class="nf">rename_masking_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">masking_view_id</span><span class="p">,</span> <span class="n">new_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rename an existing masking view.</span>

<span class="sd">        Currently, the only supported modification is &quot;rename&quot;.</span>

<span class="sd">        :param masking_view_id: the current name of the masking view</span>
<span class="sd">        :param new_name: the new name of the masking view</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mv_payload</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;editMaskingViewActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;renameMaskingViewParam&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;new_masking_view_name&#39;</span><span class="p">:</span> <span class="n">new_name</span><span class="p">}}}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;maskingview&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="n">mv_payload</span><span class="p">,</span>
            <span class="n">version</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">resource_name</span><span class="o">=</span><span class="n">masking_view_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_host_from_maskingview"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_host_from_maskingview">[docs]</a>    <span class="k">def</span> <span class="nf">get_host_from_maskingview</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">masking_view_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Given a masking view, get the associated host or host group.</span>

<span class="sd">        :param masking_view_id: the name of the masking view</span>
<span class="sd">        :returns: host ID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_element_from_masking_view</span><span class="p">(</span><span class="n">masking_view_id</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_storagegroup_from_maskingview"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_storagegroup_from_maskingview">[docs]</a>    <span class="k">def</span> <span class="nf">get_storagegroup_from_maskingview</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">masking_view_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Given a masking view, get the associated storage group.</span>

<span class="sd">        :param masking_view_id: the masking view name</span>
<span class="sd">        :returns: the name of the storage group</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_element_from_masking_view</span><span class="p">(</span>
            <span class="n">masking_view_id</span><span class="p">,</span> <span class="n">storagegroup</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_portgroup_from_maskingview"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_portgroup_from_maskingview">[docs]</a>    <span class="k">def</span> <span class="nf">get_portgroup_from_maskingview</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">masking_view_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Given a masking view, get the associated port group.</span>

<span class="sd">        :param masking_view_id: the masking view name</span>
<span class="sd">        :returns: the name of the port group</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_element_from_masking_view</span><span class="p">(</span>
            <span class="n">masking_view_id</span><span class="p">,</span> <span class="n">portgroup</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_maskingview_connections"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_maskingview_connections">[docs]</a>    <span class="k">def</span> <span class="nf">get_maskingview_connections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mv_name</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get all connection information for a given masking view.</span>

<span class="sd">        :param mv_name: the name of the masking view</span>
<span class="sd">        :param filters: dict of optional filter parameters</span>
<span class="sd">        :returns: list of masking view connection dicts</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{mv_name}</span><span class="s1">/connections&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mv_name</span><span class="o">=</span><span class="n">mv_name</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span>
            <span class="s1">&#39;maskingview&#39;</span><span class="p">,</span> <span class="n">resource_name</span><span class="o">=</span><span class="n">res_name</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
        <span class="n">mv_conn_list</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s1">&#39;maskingViewConnection&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">response</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">mv_conn_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.find_host_lun_id_for_vol"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.find_host_lun_id_for_vol">[docs]</a>    <span class="k">def</span> <span class="nf">find_host_lun_id_for_vol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maskingview</span><span class="p">,</span> <span class="n">device_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Find the host_lun_id for a volume in a masking view.</span>

<span class="sd">        :param maskingview: the masking view name</span>
<span class="sd">        :param device_id: the device ID</span>
<span class="sd">        :returns: host_lun_id -- int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">host_lun_id</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;volume_id&#39;</span><span class="p">:</span> <span class="n">device_id</span><span class="p">}</span>
        <span class="n">connection_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_maskingview_connections</span><span class="p">(</span>
            <span class="n">maskingview</span><span class="p">,</span> <span class="n">filters</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">connection_info</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Cannot retrieve masking view connection information &#39;</span>
                      <span class="s1">&#39;for </span><span class="si">%(device_id)s</span><span class="s1"> in </span><span class="si">%(maskingview)s</span><span class="s1">.&#39;</span><span class="p">,</span>
                      <span class="p">{</span><span class="s1">&#39;device_id&#39;</span><span class="p">:</span> <span class="n">device_id</span><span class="p">,</span>
                       <span class="s1">&#39;maskingview&#39;</span><span class="p">:</span> <span class="n">maskingview</span><span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">host_lun_id</span> <span class="o">=</span> <span class="p">(</span><span class="n">connection_info</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;host_lun_address&#39;</span><span class="p">])</span>
                <span class="n">host_lun_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">host_lun_id</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">LOG</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Unable to retrieve connection information &#39;</span>
                          <span class="s1">&#39;for volume </span><span class="si">%(vol)s</span><span class="s1"> in masking view </span><span class="si">%(mv)s</span><span class="s1">. &#39;</span>
                          <span class="s1">&#39;Exception received: </span><span class="si">%(e)s</span><span class="s1">.&#39;</span><span class="p">,</span>
                          <span class="p">{</span><span class="s1">&#39;vol&#39;</span><span class="p">:</span> <span class="n">device_id</span><span class="p">,</span> <span class="s1">&#39;mv&#39;</span><span class="p">:</span> <span class="n">maskingview</span><span class="p">,</span>
                           <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="n">e</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">host_lun_id</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_port_list"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_port_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_port_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Query for a list of Symmetrix port keys.</span>

<span class="sd">        Note a mixture of Front end, back end and RDF port specific values</span>
<span class="sd">        are not allowed. See UniSphere documentation for possible values.</span>

<span class="sd">        :param filters: dictionary of filters e.g. {&#39;vnx_attached&#39;: &#39;true&#39;}</span>
<span class="sd">        :returns: list of port key dicts</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;port&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
        <span class="n">port_key_list</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s1">&#39;symmetrixPortKey&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="k">if</span> <span class="n">response</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">port_key_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_portgroup"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_portgroup">[docs]</a>    <span class="k">def</span> <span class="nf">get_portgroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">portgroup_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get portgroup details.</span>

<span class="sd">        :param portgroup_id: the name of the portgroup</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;portgroup&#39;</span><span class="p">,</span>
                                 <span class="n">resource_name</span><span class="o">=</span><span class="n">portgroup_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_portgroup_list"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_portgroup_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_portgroup_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get portgroup details.</span>

<span class="sd">        :param filters: dict of optional filters</span>
<span class="sd">        :returns: list of portgroups</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span>
                                     <span class="s1">&#39;portgroup&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
        <span class="n">port_group_list</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;portGroupId&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="k">if</span> <span class="n">response</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">port_group_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_ports_from_pg"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_ports_from_pg">[docs]</a>    <span class="k">def</span> <span class="nf">get_ports_from_pg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">portgroup</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a list of port identifiers from a port group.</span>

<span class="sd">        :param portgroup: the name of the portgroup</span>
<span class="sd">        :returns: list of port ids, e.g. [&#39;FA-3D:35&#39;, &#39;FA-4D:32&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">portlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">portgroup_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_portgroup</span><span class="p">(</span><span class="n">portgroup</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">portgroup_info</span> <span class="ow">and</span> <span class="n">portgroup_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;symmetrixPortKey&#39;</span><span class="p">):</span>
            <span class="n">port_key</span> <span class="o">=</span> <span class="n">portgroup_info</span><span class="p">[</span><span class="s1">&#39;symmetrixPortKey&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">port_key</span><span class="p">:</span>
                <span class="n">port</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="s1">&#39;portId&#39;</span><span class="p">]</span>
                <span class="n">portlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">port</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">portlist</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_target_wwns_from_pg"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_target_wwns_from_pg">[docs]</a>    <span class="k">def</span> <span class="nf">get_target_wwns_from_pg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">portgroup_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the director ports&#39; wwns.</span>

<span class="sd">        :param portgroup_id: the name of the portgroup</span>
<span class="sd">        :returns: target_wwns -- the list of target wwns for the pg</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">target_wwns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">port_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ports_from_pg</span><span class="p">(</span><span class="n">portgroup_id</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">port</span> <span class="ow">in</span> <span class="n">port_ids</span><span class="p">:</span>
            <span class="n">dir_id</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">port_no</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">wwn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_port_identifier</span><span class="p">(</span><span class="n">dir_id</span><span class="p">,</span> <span class="n">port_no</span><span class="p">)</span>
            <span class="n">target_wwns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wwn</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">target_wwns</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_iscsi_ip_address_and_iqn"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_iscsi_ip_address_and_iqn">[docs]</a>    <span class="k">def</span> <span class="nf">get_iscsi_ip_address_and_iqn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">port_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the ip addresses from the director port.</span>

<span class="sd">        :param port_id: the director port identifier</span>
<span class="sd">        :returns: (list of ip_addresses, iqn)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ip_addresses</span><span class="p">,</span> <span class="n">iqn</span> <span class="o">=</span> <span class="p">[],</span> <span class="kc">None</span>
        <span class="n">dir_id</span> <span class="o">=</span> <span class="n">port_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">port_no</span> <span class="o">=</span> <span class="n">port_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">port_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_director_port</span><span class="p">(</span><span class="n">dir_id</span><span class="p">,</span> <span class="n">port_no</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">port_details</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ip_addresses</span> <span class="o">=</span> <span class="n">port_details</span><span class="p">[</span><span class="s1">&#39;symmetrixPort&#39;</span><span class="p">][</span><span class="s1">&#39;ip_addresses&#39;</span><span class="p">]</span>
                <span class="n">iqn</span> <span class="o">=</span> <span class="n">port_details</span><span class="p">[</span><span class="s1">&#39;symmetrixPort&#39;</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                <span class="k">pass</span>
        <span class="k">return</span> <span class="n">ip_addresses</span><span class="p">,</span> <span class="n">iqn</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.create_portgroup"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.create_portgroup">[docs]</a>    <span class="k">def</span> <span class="nf">create_portgroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">portgroup_id</span><span class="p">,</span> <span class="n">director_id</span><span class="p">,</span> <span class="n">port_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new portgroup.</span>

<span class="sd">        :param portgroup_id: the name of the new port group</span>
<span class="sd">        :param director_id: the directoy id</span>
<span class="sd">        :param port_id: the port id</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;portGroupId&#39;</span><span class="p">:</span> <span class="n">portgroup_id</span><span class="p">,</span>
                    <span class="s1">&#39;symmetrixPortKey&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;directorId&#39;</span><span class="p">:</span> <span class="n">director_id</span><span class="p">,</span>
                                          <span class="s1">&#39;portId&#39;</span><span class="p">:</span> <span class="n">port_id</span><span class="p">}]})</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;portgroup&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.create_multiport_portgroup"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.create_multiport_portgroup">[docs]</a>    <span class="k">def</span> <span class="nf">create_multiport_portgroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">portgroup_id</span><span class="p">,</span> <span class="n">ports</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new portgroup.</span>

<span class="sd">        :param portgroup_id: the name of the new port group</span>
<span class="sd">        :param ports: list of port dicts - {&#39;directorId&#39;: director_id,</span>
<span class="sd">                                            &#39;portId&#39;: port_id}</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;portGroupId&#39;</span><span class="p">:</span> <span class="n">portgroup_id</span><span class="p">,</span>
                    <span class="s1">&#39;symmetrixPortKey&#39;</span><span class="p">:</span> <span class="n">ports</span><span class="p">})</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;portgroup&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.create_portgroup_from_file"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.create_portgroup_from_file">[docs]</a>    <span class="k">def</span> <span class="nf">create_portgroup_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">portgroup_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Given a file with director:port pairs, create a portgroup.</span>

<span class="sd">        Each director:port pair must be on a new line.</span>
<span class="sd">        Example director:port - FA-1D:4.</span>

<span class="sd">        :param file_name: the path to the file</span>
<span class="sd">        :param portgroup_id: the name for the portgroup</span>
<span class="sd">        :returns: dict, status_code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">port_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">create_list_from_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="n">combined_payload</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">port_list</span><span class="p">:</span>
            <span class="n">current_director_id</span><span class="p">,</span> <span class="n">current_port_id</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">temp_list</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;directorId&#39;</span><span class="p">:</span> <span class="n">current_director_id</span><span class="p">,</span>
                         <span class="s1">&#39;portId&#39;</span><span class="p">:</span> <span class="n">current_port_id</span><span class="p">}</span>
            <span class="n">combined_payload</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_list</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_multiport_portgroup</span><span class="p">(</span><span class="n">portgroup_id</span><span class="p">,</span> <span class="n">combined_payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.modify_portgroup"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.modify_portgroup">[docs]</a>    <span class="k">def</span> <span class="nf">modify_portgroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">portgroup_id</span><span class="p">,</span> <span class="n">remove_port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add_port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">rename_portgroup</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modify an existing portgroup.</span>

<span class="sd">        Only one parameter can be modified at a time.</span>

<span class="sd">        :param portgroup_id: the name of the portgroup</span>
<span class="sd">        :param remove_port: tuple of port details ($director_id, $portId)</span>
<span class="sd">        :param add_port: tuple of port details ($director_id, $portId)</span>
<span class="sd">        :param rename_portgroup: new portgroup name</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">remove_port</span><span class="p">:</span>
            <span class="n">edit_pg_data</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;editPortGroupActionParam&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;removePortParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;directorId&#39;</span><span class="p">:</span> <span class="n">remove_port</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                          <span class="s1">&#39;portId&#39;</span><span class="p">:</span> <span class="n">remove_port</span><span class="p">[</span><span class="mi">1</span><span class="p">]}]}}})</span>
        <span class="k">elif</span> <span class="n">add_port</span><span class="p">:</span>
            <span class="n">edit_pg_data</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;editPortGroupActionParam&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;addPortParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;directorId&#39;</span><span class="p">:</span> <span class="n">add_port</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                          <span class="s1">&#39;portId&#39;</span><span class="p">:</span> <span class="n">add_port</span><span class="p">[</span><span class="mi">1</span><span class="p">]}]}}})</span>
        <span class="k">elif</span> <span class="n">rename_portgroup</span><span class="p">:</span>
            <span class="n">edit_pg_data</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;editPortGroupActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;renamePortGroupParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;new_port_group_name&#39;</span><span class="p">:</span> <span class="n">rename_portgroup</span><span class="p">}}})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;No modify portgroup parameters set - please set one &#39;</span>
                       <span class="s1">&#39;of the following: remove_port, add_port, or &#39;</span>
                       <span class="s1">&#39;rename_portgroup.&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">exception</span><span class="o">.</span><span class="n">InvalidInputException</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">message</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;portgroup&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="n">edit_pg_data</span><span class="p">,</span>
            <span class="n">resource_name</span><span class="o">=</span><span class="n">portgroup_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.delete_portgroup"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.delete_portgroup">[docs]</a>    <span class="k">def</span> <span class="nf">delete_portgroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">portgroup_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete a portgroup.</span>

<span class="sd">        :param portgroup_id: the name of the portgroup</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span>
                             <span class="s1">&#39;portgroup&#39;</span><span class="p">,</span> <span class="n">resource_name</span><span class="o">=</span><span class="n">portgroup_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_slo_list"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_slo_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_slo_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve the list of slo&#39;s from the array.</span>

<span class="sd">        :returns: slo_list -- list of service level names</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">slo_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;slo&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
        <span class="n">slo_list</span> <span class="o">=</span> <span class="n">slo_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sloId&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="k">if</span> <span class="n">slo_dict</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">slo_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_slo"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_slo">[docs]</a>    <span class="k">def</span> <span class="nf">get_slo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slo_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get details on a specific service level.</span>

<span class="sd">        :param slo_id: the service level agreement</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;slo&#39;</span><span class="p">,</span>
                                 <span class="n">resource_name</span><span class="o">=</span><span class="n">slo_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.modify_slo"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.modify_slo">[docs]</a>    <span class="k">def</span> <span class="nf">modify_slo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slo_id</span><span class="p">,</span> <span class="n">new_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modify an SLO.</span>

<span class="sd">        Currently, the only modification permitted is renaming.</span>

<span class="sd">        :param slo_id: the current name of the slo</span>
<span class="sd">        :param new_name: the new name for the slo</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">edit_slo_data</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;editSloActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;renameSloParam&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;sloId&#39;</span><span class="p">:</span> <span class="n">new_name</span><span class="p">}}})</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="n">edit_slo_data</span><span class="p">,</span>
            <span class="n">resource_name</span><span class="o">=</span><span class="n">slo_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_srp"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_srp">[docs]</a>    <span class="k">def</span> <span class="nf">get_srp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">srp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get details on a specific SRP.</span>

<span class="sd">        :param srp: the storage resource pool</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;srp&#39;</span><span class="p">,</span>
                                 <span class="n">resource_name</span><span class="o">=</span><span class="n">srp</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_srp_list"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_srp_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_srp_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a list of available SRP&#39;s on a given array.</span>

<span class="sd">        :param filters: optional dict of filter parameters</span>
<span class="sd">        :returns: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;srp&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
        <span class="n">srp_list</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;srpId&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="k">if</span> <span class="n">response</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">srp_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_compressibility_report"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_compressibility_report">[docs]</a>    <span class="k">def</span> <span class="nf">get_compressibility_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">srp_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a specified SRP Compressibility Report.</span>

<span class="sd">        :param srp_id: the srp id</span>
<span class="sd">        :returns: list of compressibility reports</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{srp_id}</span><span class="s1">/compressibility_report&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">srp_id</span><span class="o">=</span><span class="n">srp_id</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;srp&#39;</span><span class="p">,</span> <span class="n">resource_name</span><span class="o">=</span><span class="n">res_name</span><span class="p">)</span>
        <span class="n">report_list</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s1">&#39;storageGroupCompressibility&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="k">if</span> <span class="n">response</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">report_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.is_compression_capable"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.is_compression_capable">[docs]</a>    <span class="k">def</span> <span class="nf">is_compression_capable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if array is compression capable.</span>

<span class="sd">        :returns: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">array_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">get_v3_or_newer_array_list</span><span class="p">(</span>
            <span class="n">filters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;compressionCapable&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span><span class="p">})</span>
        <span class="k">return</span> <span class="kc">True</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span> <span class="ow">in</span> <span class="n">array_list</span> <span class="k">else</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_storage_group"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_storage_group">[docs]</a>    <span class="k">def</span> <span class="nf">get_storage_group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_group_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Given a name, return storage group details.</span>

<span class="sd">        :param storage_group_name: the name of the storage group</span>
<span class="sd">        :returns: storage group dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;storagegroup&#39;</span><span class="p">,</span>
            <span class="n">resource_name</span><span class="o">=</span><span class="n">storage_group_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_storage_group_demand_report"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_storage_group_demand_report">[docs]</a>    <span class="k">def</span> <span class="nf">get_storage_group_demand_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the storage group demand report.</span>

<span class="sd">        Get the storage group demand report from Unisphere.</span>
<span class="sd">        Functionality only available in unisphere 9.0</span>
<span class="sd">        assumes single SRP SRP_1</span>
<span class="sd">        :returns: returns report</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;srp&#39;</span><span class="p">,</span>
            <span class="n">resource_name</span><span class="o">=</span><span class="s2">&quot;SRP_1/storage_group_demand_report&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_storage_group_list"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_storage_group_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_storage_group_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a list of storage groups.</span>

<span class="sd">        :param filters: optional filter parameters</span>
<span class="sd">        :returns: storage group list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sg_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;storagegroup&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
        <span class="n">sg_list</span> <span class="o">=</span> <span class="n">sg_details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;storageGroupId&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="k">if</span> <span class="n">sg_details</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">sg_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_mv_from_sg"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_mv_from_sg">[docs]</a>    <span class="k">def</span> <span class="nf">get_mv_from_sg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_group</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the associated masking views from a given storage group.</span>

<span class="sd">        :param storage_group: the name of the storage group</span>
<span class="sd">        :returns: Masking view list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_storage_group</span><span class="p">(</span><span class="n">storage_group</span><span class="p">)</span>
        <span class="n">maskingview_list</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;maskingview&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="k">if</span> <span class="n">response</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">maskingview_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_num_vols_in_sg"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_num_vols_in_sg">[docs]</a>    <span class="k">def</span> <span class="nf">get_num_vols_in_sg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_group_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the number of volumes in a storage group.</span>

<span class="sd">        :param storage_group_name: the storage group name</span>
<span class="sd">        :returns: num_vols -- int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">storagegroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_storage_group</span><span class="p">(</span><span class="n">storage_group_name</span><span class="p">)</span>
        <span class="n">num_vols</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">storagegroup</span><span class="p">[</span><span class="s1">&#39;num_of_vols&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="n">storagegroup</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="n">storagegroup</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;num_of_vols&#39;</span><span class="p">))</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">num_vols</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.is_child_sg_in_parent_sg"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.is_child_sg_in_parent_sg">[docs]</a>    <span class="k">def</span> <span class="nf">is_child_sg_in_parent_sg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_name</span><span class="p">,</span> <span class="n">parent_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if a child storage group is a member of a parent group.</span>

<span class="sd">        :param child_name: the child sg name</span>
<span class="sd">        :param parent_name: the parent sg name</span>
<span class="sd">        :returns: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parent_sg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_storage_group</span><span class="p">(</span><span class="n">parent_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parent_sg</span> <span class="ow">and</span> <span class="n">parent_sg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;child_storage_group&#39;</span><span class="p">):</span>
            <span class="n">child_sg_list</span> <span class="o">=</span> <span class="n">parent_sg</span><span class="p">[</span><span class="s1">&#39;child_storage_group&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">child_name</span> <span class="ow">in</span> <span class="n">child_sg_list</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_child_sg_from_parent"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_child_sg_from_parent">[docs]</a>    <span class="k">def</span> <span class="nf">get_child_sg_from_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get child storage group list.</span>

<span class="sd">        :param parent_name: the parent sg name</span>
<span class="sd">        :returns: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">child_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">parent_sg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_storage_group</span><span class="p">(</span><span class="n">parent_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parent_sg</span> <span class="ow">and</span> <span class="n">parent_sg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;child_storage_group&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">parent_sg</span><span class="p">[</span><span class="s1">&#39;child_storage_group&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">child_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.create_storage_group"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.create_storage_group">[docs]</a>    <span class="k">def</span> <span class="nf">create_storage_group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">srp_id</span><span class="p">,</span> <span class="n">sg_id</span><span class="p">,</span> <span class="n">slo</span><span class="p">,</span> <span class="n">workload</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">do_disable_compression</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                             <span class="n">num_vols</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vol_size</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">cap_unit</span><span class="o">=</span><span class="s1">&#39;GB&#39;</span><span class="p">,</span>
                             <span class="n">allocate_full</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">_async</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">vol_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create the volume in the specified storage group.</span>

<span class="sd">        :param srp_id: the SRP (String)</span>
<span class="sd">        :param sg_id: the group name (String)</span>
<span class="sd">        :param slo: the SLO (String)</span>
<span class="sd">        :param workload: the workload (String)</span>
<span class="sd">        :param do_disable_compression: flag for disabling compression</span>
<span class="sd">        :param num_vols: number of volumes to be created</span>
<span class="sd">        :param vol_size: the volume size</span>
<span class="sd">        :param cap_unit: the capacity unit (MB, GB, TB, CYL)</span>
<span class="sd">        :param allocate_full: boolean to indicate if you want a thick volume</span>
<span class="sd">        :param async: Flag to indicate if call should be async</span>
<span class="sd">        :param vol_name: name to give to the volume, optional</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">srp_id</span> <span class="o">=</span> <span class="n">srp_id</span> <span class="k">if</span> <span class="n">slo</span> <span class="k">else</span> <span class="s1">&#39;None&#39;</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;srpId&#39;</span><span class="p">:</span> <span class="n">srp_id</span><span class="p">,</span>
                    <span class="s1">&#39;storageGroupId&#39;</span><span class="p">:</span> <span class="n">sg_id</span><span class="p">,</span>
                    <span class="s1">&#39;emulation&#39;</span><span class="p">:</span> <span class="s1">&#39;FBA&#39;</span><span class="p">})</span>

        <span class="k">if</span> <span class="n">slo</span><span class="p">:</span>
            <span class="n">slo_param</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;num_of_vols&#39;</span><span class="p">:</span> <span class="n">num_vols</span><span class="p">,</span>
                         <span class="s1">&#39;sloId&#39;</span><span class="p">:</span> <span class="n">slo</span><span class="p">,</span>
                         <span class="s1">&#39;workloadSelection&#39;</span><span class="p">:</span> <span class="n">workload</span><span class="p">,</span>
                         <span class="s1">&#39;volumeAttribute&#39;</span><span class="p">:</span> <span class="p">{</span>
                             <span class="s1">&#39;volume_size&#39;</span><span class="p">:</span> <span class="n">vol_size</span><span class="p">,</span>
                             <span class="s1">&#39;capacityUnit&#39;</span><span class="p">:</span> <span class="n">cap_unit</span><span class="p">}}</span>
            <span class="k">if</span> <span class="n">do_disable_compression</span><span class="p">:</span>
                <span class="n">slo_param</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;noCompression&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span><span class="p">})</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_compression_capable</span><span class="p">():</span>
                <span class="n">slo_param</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;noCompression&#39;</span><span class="p">:</span> <span class="s1">&#39;false&#39;</span><span class="p">})</span>
            <span class="k">if</span> <span class="n">vol_name</span><span class="p">:</span>
                <span class="n">slo_param</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                    <span class="s1">&#39;volumeIdentifier&#39;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s1">&#39;identifier_name&#39;</span><span class="p">:</span> <span class="n">vol_name</span><span class="p">,</span>
                        <span class="s1">&#39;volumeIdentifierChoice&#39;</span><span class="p">:</span> <span class="s1">&#39;identifier_name&#39;</span><span class="p">}})</span>

            <span class="k">if</span> <span class="n">allocate_full</span><span class="p">:</span>
                <span class="c1"># If case of full volume allocation, we must set the</span>
                <span class="c1"># noCompression parameter at true because fully</span>
                <span class="c1"># allocations and compression are exclusive parameters</span>
                <span class="n">slo_param</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;noCompression&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span><span class="p">})</span>
                <span class="n">slo_param</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;allocate_capacity_for_each_vol&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span><span class="p">})</span>
                <span class="n">slo_param</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;persist_preallocated_capacity_through_&#39;</span>
                                  <span class="s1">&#39;reclaim_or_copy&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span><span class="p">})</span>

            <span class="n">payload</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;sloBasedStorageGroupParam&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">slo_param</span><span class="p">]})</span>

        <span class="k">if</span> <span class="n">_async</span><span class="p">:</span>
            <span class="n">payload</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ASYNC_UPDATE</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;storagegroup&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.create_non_empty_storagegroup"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.create_non_empty_storagegroup">[docs]</a>    <span class="k">def</span> <span class="nf">create_non_empty_storagegroup</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">srp_id</span><span class="p">,</span> <span class="n">sg_id</span><span class="p">,</span> <span class="n">slo</span><span class="p">,</span> <span class="n">workload</span><span class="p">,</span> <span class="n">num_vols</span><span class="p">,</span> <span class="n">vol_size</span><span class="p">,</span>
            <span class="n">cap_unit</span><span class="p">,</span> <span class="n">disable_compression</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">_async</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new storage group with the specified volumes.</span>

<span class="sd">        Generates a dictionary for json formatting and calls the</span>
<span class="sd">        create_sg function to create a new storage group with the</span>
<span class="sd">        specified volumes. Set the disable_compression flag for</span>
<span class="sd">        disabling compression on an All Flash array (where compression</span>
<span class="sd">        is on by default).</span>

<span class="sd">        :param srp_id: the storage resource pool</span>
<span class="sd">        :param sg_id: the name of the new storage group</span>
<span class="sd">        :param slo: the service level agreement (e.g. Gold)</span>
<span class="sd">        :param workload: the workload (e.g. DSS)</span>
<span class="sd">        :param num_vols: the amount of volumes to be created -- int</span>
<span class="sd">        :param vol_size: the size of each volume -- string</span>
<span class="sd">        :param cap_unit: the capacity unit (MB, GB)</span>
<span class="sd">        :param disable_compression: Flag for disabling compression (AF only)</span>
<span class="sd">        :param _async: Flag to indicate if this call should be async</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_storage_group</span><span class="p">(</span>
            <span class="n">srp_id</span><span class="p">,</span> <span class="n">sg_id</span><span class="p">,</span> <span class="n">slo</span><span class="p">,</span> <span class="n">workload</span><span class="p">,</span>
            <span class="n">do_disable_compression</span><span class="o">=</span><span class="n">disable_compression</span><span class="p">,</span>
            <span class="n">num_vols</span><span class="o">=</span><span class="n">num_vols</span><span class="p">,</span> <span class="n">vol_size</span><span class="o">=</span><span class="n">vol_size</span><span class="p">,</span> <span class="n">cap_unit</span><span class="o">=</span><span class="n">cap_unit</span><span class="p">,</span>
            <span class="n">_async</span><span class="o">=</span><span class="n">_async</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.create_empty_sg"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.create_empty_sg">[docs]</a>    <span class="k">def</span> <span class="nf">create_empty_sg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">srp_id</span><span class="p">,</span> <span class="n">sg_id</span><span class="p">,</span> <span class="n">slo</span><span class="p">,</span> <span class="n">workload</span><span class="p">,</span>
                        <span class="n">disable_compression</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">_async</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an empty storage group.</span>

<span class="sd">        Set the disable_compression flag for disabling compression</span>
<span class="sd">        on an All Flash array (where compression is on by default).</span>

<span class="sd">        :param srp_id: the storage resource pool</span>
<span class="sd">        :param sg_id: the name of the new storage group</span>
<span class="sd">        :param slo: the service level agreement (e.g. Gold)</span>
<span class="sd">        :param workload: the workload (e.g. DSS)</span>
<span class="sd">        :param disable_compression: flag for disabling compression (AF only)</span>
<span class="sd">        :param _async: Flag to indicate if this call should be asyncronously</span>
<span class="sd">                       executed</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_storage_group</span><span class="p">(</span>
            <span class="n">srp_id</span><span class="p">,</span> <span class="n">sg_id</span><span class="p">,</span> <span class="n">slo</span><span class="p">,</span> <span class="n">workload</span><span class="p">,</span>
            <span class="n">do_disable_compression</span><span class="o">=</span><span class="n">disable_compression</span><span class="p">,</span> <span class="n">_async</span><span class="o">=</span><span class="n">_async</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.modify_storage_group"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.modify_storage_group">[docs]</a>    <span class="k">def</span> <span class="nf">modify_storage_group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storagegroup</span><span class="p">,</span> <span class="n">payload</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modify a storage group (PUT operation).</span>

<span class="sd">        :param storagegroup: storage group name</span>
<span class="sd">        :param payload: the request payload</span>
<span class="sd">        :returns: message -- dict, server response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;storagegroup&#39;</span><span class="p">,</span>
            <span class="n">payload</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">resource_name</span><span class="o">=</span><span class="n">storagegroup</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.add_existing_vol_to_sg"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.add_existing_vol_to_sg">[docs]</a>    <span class="k">def</span> <span class="nf">add_existing_vol_to_sg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sg_id</span><span class="p">,</span> <span class="n">vol_ids</span><span class="p">,</span> <span class="n">_async</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Expand an existing storage group by adding existing volumes.</span>

<span class="sd">        :param sg_id: the name of the storage group</span>
<span class="sd">        :param vol_ids: the device id of the volume - can be list</span>
<span class="sd">        :param _async: Flag to indicate if the call should be async</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vol_ids</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">vol_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">vol_ids</span><span class="p">]</span>
        <span class="n">add_vol_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;editStorageGroupActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;expandStorageGroupParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;addSpecificVolumeParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;volumeId&#39;</span><span class="p">:</span> <span class="n">vol_ids</span><span class="p">}}}}</span>
        <span class="k">if</span> <span class="n">_async</span><span class="p">:</span>
            <span class="n">add_vol_data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ASYNC_UPDATE</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_storage_group</span><span class="p">(</span><span class="n">sg_id</span><span class="p">,</span> <span class="n">add_vol_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.add_new_vol_to_storagegroup"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.add_new_vol_to_storagegroup">[docs]</a>    <span class="k">def</span> <span class="nf">add_new_vol_to_storagegroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sg_id</span><span class="p">,</span> <span class="n">num_vols</span><span class="p">,</span> <span class="n">vol_size</span><span class="p">,</span>
                                    <span class="n">cap_unit</span><span class="p">,</span> <span class="n">_async</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">vol_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                    <span class="n">create_new_volumes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Expand an existing storage group by adding new volumes.</span>

<span class="sd">        :param sg_id: the name of the storage group</span>
<span class="sd">        :param num_vols: the number of volumes</span>
<span class="sd">        :param vol_size: the size of the volumes</span>
<span class="sd">        :param cap_unit: the capacity unit</span>
<span class="sd">        :param _async: Flag to indicate if call should be async</span>
<span class="sd">        :param vol_name: name to give to the volume, optional</span>
<span class="sd">        :param create_new_volumes: when true will force create new</span>
<span class="sd">                                   volumes, optional</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">add_vol_info</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;num_of_vols&#39;</span><span class="p">:</span> <span class="n">num_vols</span><span class="p">,</span>
            <span class="s1">&#39;emulation&#39;</span><span class="p">:</span> <span class="s1">&#39;FBA&#39;</span><span class="p">,</span>
            <span class="s1">&#39;volumeAttribute&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;volume_size&#39;</span><span class="p">:</span> <span class="n">vol_size</span><span class="p">,</span>
                <span class="s1">&#39;capacityUnit&#39;</span><span class="p">:</span> <span class="n">cap_unit</span><span class="p">}}</span>
        <span class="k">if</span> <span class="n">vol_name</span><span class="p">:</span>
            <span class="n">add_vol_info</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                <span class="s1">&#39;volumeIdentifier&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;identifier_name&#39;</span><span class="p">:</span> <span class="n">vol_name</span><span class="p">,</span>
                    <span class="s1">&#39;volumeIdentifierChoice&#39;</span><span class="p">:</span> <span class="s1">&#39;identifier_name&#39;</span><span class="p">}})</span>
        <span class="n">expand_sg_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;editStorageGroupActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;expandStorageGroupParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;addVolumeParam&#39;</span><span class="p">:</span> <span class="n">add_vol_info</span><span class="p">}}}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">create_new_volumes</span><span class="p">:</span>
            <span class="n">add_vol_info</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                <span class="s1">&#39;create_new_volumes&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">_async</span><span class="p">:</span>
            <span class="n">expand_sg_data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ASYNC_UPDATE</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_storage_group</span><span class="p">(</span><span class="n">sg_id</span><span class="p">,</span> <span class="n">expand_sg_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.remove_vol_from_storagegroup"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.remove_vol_from_storagegroup">[docs]</a>    <span class="k">def</span> <span class="nf">remove_vol_from_storagegroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sg_id</span><span class="p">,</span> <span class="n">vol_id</span><span class="p">,</span> <span class="n">_async</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove a volume from a given storage group.</span>

<span class="sd">        :param sg_id: the name of the storage group</span>
<span class="sd">        :param vol_id: the device id of the volume</span>
<span class="sd">        :param _async: Flag to indicate if call should be async</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vol_id</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">vol_id</span> <span class="o">=</span> <span class="p">[</span><span class="n">vol_id</span><span class="p">]</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;editStorageGroupActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;removeVolumeParam&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;volumeId&#39;</span><span class="p">:</span> <span class="n">vol_id</span><span class="p">}}}</span>
        <span class="k">if</span> <span class="n">_async</span><span class="p">:</span>
            <span class="n">payload</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ASYNC_UPDATE</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_storage_group</span><span class="p">(</span><span class="n">sg_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.move_volumes_between_storage_groups"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.move_volumes_between_storage_groups">[docs]</a>    <span class="k">def</span> <span class="nf">move_volumes_between_storage_groups</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">device_ids</span><span class="p">,</span> <span class="n">source_storagegroup_name</span><span class="p">,</span>
            <span class="n">target_storagegroup_name</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">_async</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Move volumes to a different storage group.</span>

<span class="sd">        Note: 8.4.0.7 or later</span>

<span class="sd">        :param source_storagegroup_name: the originating storage group name</span>
<span class="sd">        :param target_storagegroup_name: the destination storage group name</span>
<span class="sd">        :param device_ids: the device ids - can be list</span>
<span class="sd">        :param force: force flag (necessary if volume is in masking view)</span>
<span class="sd">        :param _async: _async flag</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">force_flag</span> <span class="o">=</span> <span class="s1">&#39;true&#39;</span> <span class="k">if</span> <span class="n">force</span> <span class="k">else</span> <span class="s1">&#39;false&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">device_ids</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">device_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">device_ids</span><span class="p">]</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="p">({</span>
            <span class="s1">&#39;editStorageGroupActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;moveVolumeToStorageGroupParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;volumeId&#39;</span><span class="p">:</span> <span class="n">device_ids</span><span class="p">,</span>
                    <span class="s1">&#39;storageGroupId&#39;</span><span class="p">:</span> <span class="n">target_storagegroup_name</span><span class="p">,</span>
                    <span class="s1">&#39;force&#39;</span><span class="p">:</span> <span class="n">force_flag</span><span class="p">}}})</span>
        <span class="k">if</span> <span class="n">_async</span><span class="p">:</span>
            <span class="n">payload</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ASYNC_UPDATE</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_storage_group</span><span class="p">(</span><span class="n">source_storagegroup_name</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.create_volume_from_sg_return_dev_id"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.create_volume_from_sg_return_dev_id">[docs]</a>    <span class="k">def</span> <span class="nf">create_volume_from_sg_return_dev_id</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">volume_name</span><span class="p">,</span> <span class="n">storagegroup_name</span><span class="p">,</span>
            <span class="n">vol_size</span><span class="p">,</span> <span class="n">cap_unit</span><span class="o">=</span><span class="s1">&#39;GB&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new volume in the given storage group.</span>

<span class="sd">        :param volume_name: the volume name (String)</span>
<span class="sd">        :param storagegroup_name: the storage group name</span>
<span class="sd">        :param vol_size: volume size (String)</span>
<span class="sd">        :param cap_unit: the capacity unit, default &#39;GB&#39;</span>
<span class="sd">        :returns: device_id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">job</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_new_vol_to_storagegroup</span><span class="p">(</span>
            <span class="n">storagegroup_name</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">vol_size</span><span class="p">,</span> <span class="n">cap_unit</span><span class="p">,</span>
            <span class="n">_async</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vol_name</span><span class="o">=</span><span class="n">volume_name</span><span class="p">)</span>

        <span class="n">task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">wait_for_job</span><span class="p">(</span><span class="s1">&#39;Create volume from sg&#39;</span><span class="p">,</span> <span class="mi">202</span><span class="p">,</span> <span class="n">job</span><span class="p">)</span>

        <span class="c1"># Find the newly created volume.</span>
        <span class="n">device_id</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">task</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">task</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">desc</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">CREATE_VOL_STRING</span> <span class="ow">in</span> <span class="n">desc</span><span class="p">:</span>
                        <span class="n">t_list</span> <span class="o">=</span> <span class="n">desc</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                        <span class="n">device_id</span> <span class="o">=</span> <span class="n">t_list</span><span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
                        <span class="n">device_id</span> <span class="o">=</span> <span class="n">device_id</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="k">break</span>
                    <span class="k">if</span> <span class="n">device_id</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">get_volume</span><span class="p">(</span><span class="n">device_id</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Could not retrieve device id from job. &#39;</span>
                             <span class="s1">&#39;Exception received was </span><span class="si">%(e)s</span><span class="s1">. Attempting &#39;</span>
                             <span class="s1">&#39;retrieval by volume_identifier.&#39;</span><span class="p">,</span>
                             <span class="p">{</span><span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="n">e</span><span class="p">})</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">device_id</span><span class="p">:</span>
            <span class="n">device_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_volume_device_id</span><span class="p">(</span><span class="n">volume_name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">device_id</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.add_child_sg_to_parent_sg"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.add_child_sg_to_parent_sg">[docs]</a>    <span class="k">def</span> <span class="nf">add_child_sg_to_parent_sg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_sg</span><span class="p">,</span> <span class="n">parent_sg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a storage group to a parent storage group.</span>

<span class="sd">        This method adds an existing storage group to another storage</span>
<span class="sd">        group, i.e. cascaded storage groups.</span>

<span class="sd">        :param child_sg: the name of the child sg</span>
<span class="sd">        :param parent_sg: the name of the parent sg</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;editStorageGroupActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;expandStorageGroupParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;addExistingStorageGroupParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;storageGroupId&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">child_sg</span><span class="p">]}}}}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_storage_group</span><span class="p">(</span><span class="n">parent_sg</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.remove_child_sg_from_parent_sg"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.remove_child_sg_from_parent_sg">[docs]</a>    <span class="k">def</span> <span class="nf">remove_child_sg_from_parent_sg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_sg</span><span class="p">,</span> <span class="n">parent_sg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove a storage group from its parent storage group.</span>

<span class="sd">        This method removes a child storage group from its parent group.</span>

<span class="sd">        :param child_sg: the name of the child sg</span>
<span class="sd">        :param parent_sg: the name of the parent sg</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;editStorageGroupActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;removeStorageGroupParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;storageGroupId&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">child_sg</span><span class="p">],</span> <span class="s1">&#39;force&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span><span class="p">}}}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_storage_group</span><span class="p">(</span><span class="n">parent_sg</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.update_storagegroup_qos"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.update_storagegroup_qos">[docs]</a>    <span class="k">def</span> <span class="nf">update_storagegroup_qos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_group_name</span><span class="p">,</span> <span class="n">qos_specs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the storagegroupinstance with qos details.</span>

<span class="sd">        If maxIOPS or maxMBPS is in qos_specs, then DistributionType can be</span>
<span class="sd">        modified in addition to maxIOPS or/and maxMBPS</span>
<span class="sd">        If maxIOPS or maxMBPS is NOT in qos_specs, we check to see if</span>
<span class="sd">        either is set in StorageGroup. If so, then DistributionType can be</span>
<span class="sd">        modified. Example qos specs:</span>
<span class="sd">        {&#39;maxIOPS&#39;: &#39;4000&#39;, &#39;maxMBPS&#39;: &#39;4000&#39;, &#39;DistributionType&#39;: &#39;Dynamic&#39;}.</span>

<span class="sd">        :param storage_group_name: the storagegroup instance name</span>
<span class="sd">        :param qos_specs: the qos specifications</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">sg_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_storage_group</span><span class="p">(</span><span class="n">storage_group_name</span><span class="p">)</span>
        <span class="n">sg_qos_details</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">sg_maxiops</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">sg_maxmbps</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">sg_distribution_type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">maxiops</span> <span class="o">=</span> <span class="s1">&#39;nolimit&#39;</span>
        <span class="n">maxmbps</span> <span class="o">=</span> <span class="s1">&#39;nolimit&#39;</span>
        <span class="n">distribution_type</span> <span class="o">=</span> <span class="s1">&#39;Never&#39;</span>
        <span class="n">propertylist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sg_qos_details</span> <span class="o">=</span> <span class="n">sg_details</span><span class="p">[</span><span class="s1">&#39;hostIOLimit&#39;</span><span class="p">]</span>
            <span class="n">sg_maxiops</span> <span class="o">=</span> <span class="n">sg_qos_details</span><span class="p">[</span><span class="s1">&#39;host_io_limit_io_sec&#39;</span><span class="p">]</span>
            <span class="n">sg_maxmbps</span> <span class="o">=</span> <span class="n">sg_qos_details</span><span class="p">[</span><span class="s1">&#39;host_io_limit_mb_sec&#39;</span><span class="p">]</span>
            <span class="n">sg_distribution_type</span> <span class="o">=</span> <span class="n">sg_qos_details</span><span class="p">[</span><span class="s1">&#39;dynamicDistribution&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Unable to get storage group QoS details.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;maxIOPS&#39;</span> <span class="ow">in</span> <span class="n">qos_specs</span><span class="p">:</span>
            <span class="n">maxiops</span> <span class="o">=</span> <span class="n">qos_specs</span><span class="p">[</span><span class="s1">&#39;maxIOPS&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">maxiops</span> <span class="o">!=</span> <span class="n">sg_maxiops</span><span class="p">:</span>
                <span class="n">propertylist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">maxiops</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;maxMBPS&#39;</span> <span class="ow">in</span> <span class="n">qos_specs</span><span class="p">:</span>
            <span class="n">maxmbps</span> <span class="o">=</span> <span class="n">qos_specs</span><span class="p">[</span><span class="s1">&#39;maxMBPS&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">maxmbps</span> <span class="o">!=</span> <span class="n">sg_maxmbps</span><span class="p">:</span>
                <span class="n">propertylist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">maxmbps</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;DistributionType&#39;</span> <span class="ow">in</span> <span class="n">qos_specs</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="n">propertylist</span> <span class="ow">or</span> <span class="n">sg_qos_details</span><span class="p">):</span>
            <span class="n">dynamic_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;never&#39;</span><span class="p">,</span> <span class="s1">&#39;onfailure&#39;</span><span class="p">,</span> <span class="s1">&#39;always&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">qos_specs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DistributionType&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span>
                    <span class="ow">in</span> <span class="n">dynamic_list</span><span class="p">):</span>
                <span class="n">exception_message</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s1">&#39;Wrong Distribution type value </span><span class="si">{dt}</span><span class="s1"> entered. &#39;</span>
                    <span class="s1">&#39;Please enter one of: </span><span class="si">{dl}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">dt</span><span class="o">=</span><span class="n">qos_specs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DistributionType&#39;</span><span class="p">),</span>
                        <span class="n">dl</span><span class="o">=</span><span class="n">dynamic_list</span><span class="p">))</span>
                <span class="n">LOG</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">exception_message</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">exception</span><span class="o">.</span><span class="n">InvalidInputException</span><span class="p">(</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">exception_message</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">distribution_type</span> <span class="o">=</span> <span class="n">qos_specs</span><span class="p">[</span><span class="s1">&#39;DistributionType&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">distribution_type</span> <span class="o">!=</span> <span class="n">sg_distribution_type</span><span class="p">:</span>
                    <span class="n">propertylist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">distribution_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">propertylist</span><span class="p">:</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;editStorageGroupActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;setHostIOLimitsParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;host_io_limit_io_sec&#39;</span><span class="p">:</span> <span class="n">maxiops</span><span class="p">,</span>
                    <span class="s1">&#39;host_io_limit_mb_sec&#39;</span><span class="p">:</span> <span class="n">maxmbps</span><span class="p">,</span>
                    <span class="s1">&#39;dynamicDistribution&#39;</span><span class="p">:</span> <span class="n">distribution_type</span><span class="p">}}}</span>
            <span class="n">message</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">modify_storage_group</span><span class="p">(</span><span class="n">storage_group_name</span><span class="p">,</span> <span class="n">payload</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">message</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.set_host_io_limit_iops_or_mbps"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.set_host_io_limit_iops_or_mbps">[docs]</a>    <span class="k">def</span> <span class="nf">set_host_io_limit_iops_or_mbps</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">storage_group</span><span class="p">,</span> <span class="n">iops</span><span class="p">,</span> <span class="n">dynamic_distribution</span><span class="p">,</span> <span class="n">mbps</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the HOSTIO Limits on an existing storage group.</span>

<span class="sd">        :param storage_group: String up to 32 Characters</span>
<span class="sd">        :param dynamic_distribution: valid values Always, Never, OnFailure</span>
<span class="sd">        :param iops: integer value. Min Value 100, must be specified to</span>
<span class="sd">                     nearest 100, e.g.202 is not a valid value</span>
<span class="sd">        :param mbps: MB per second, integer value. Min Value 100</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qos_specs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;maxIOPS&#39;</span><span class="p">:</span> <span class="n">iops</span><span class="p">,</span>
                     <span class="s1">&#39;DistributionType&#39;</span><span class="p">:</span> <span class="n">dynamic_distribution</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">mbps</span><span class="p">:</span>
            <span class="n">qos_specs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;maxMBPS&#39;</span><span class="p">:</span> <span class="n">mbps</span><span class="p">})</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_storagegroup_qos</span><span class="p">(</span><span class="n">storage_group</span><span class="p">,</span> <span class="n">qos_specs</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.delete_storagegroup"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.delete_storagegroup">[docs]</a>    <span class="k">def</span> <span class="nf">delete_storagegroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storagegroup_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete a given storage group.</span>

<span class="sd">        A storage group cannot be deleted if it</span>
<span class="sd">        is associated with a masking view.</span>

<span class="sd">        :param storagegroup_id: the name of the storage group</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;storagegroup&#39;</span><span class="p">,</span>
            <span class="n">resource_name</span><span class="o">=</span><span class="n">storagegroup_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_volume"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_volume">[docs]</a>    <span class="k">def</span> <span class="nf">get_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a VMAX volume from array.</span>

<span class="sd">        :param device_id: the volume device id</span>
<span class="sd">        :returns: volume dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">,</span> <span class="n">resource_name</span><span class="o">=</span><span class="n">device_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_volume_list"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_volume_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_volume_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get list of volumes from array.</span>

<span class="sd">        :param filters: optional dictionary of filters</span>
<span class="sd">        :returns: list of device ids</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vol_id_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">response</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="nb">int</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)):</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span>
            <span class="n">max_page_size</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;maxPageSize&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">count</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">max_page_size</span><span class="p">):</span>
                <span class="n">total_iterations</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">count</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">max_page_size</span><span class="p">)))</span>
                <span class="n">iterator_id</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">total_iterations</span><span class="p">):</span>
                    <span class="n">start</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">max_page_size</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="n">end</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">max_page_size</span>
                    <span class="k">if</span> <span class="n">end</span> <span class="o">&gt;</span> <span class="n">count</span><span class="p">:</span>
                        <span class="n">end</span> <span class="o">=</span> <span class="n">count</span>
                    <span class="n">vol_page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">get_iterator_page_list</span><span class="p">(</span>
                        <span class="n">iterator_id</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">vol</span> <span class="ow">in</span> <span class="n">vol_page</span><span class="p">:</span>
                        <span class="n">vol_id_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vol</span><span class="p">[</span><span class="s1">&#39;volumeId&#39;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">vol</span> <span class="ow">in</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;resultList&#39;</span><span class="p">][</span><span class="s1">&#39;result&#39;</span><span class="p">]:</span>
                    <span class="n">vol_id_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vol</span><span class="p">[</span><span class="s1">&#39;volumeId&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">vol_id_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_vol_effective_wwn_details_84"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_vol_effective_wwn_details_84">[docs]</a>    <span class="k">def</span> <span class="nf">get_vol_effective_wwn_details_84</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vol_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the effective wwn for a list of vols.</span>

<span class="sd">        Get volume details for a list of volume device ids,</span>
<span class="sd">        and write results to a csv file.</span>

<span class="sd">        :param vol_list: list of device ids</span>
<span class="sd">        :returns: Dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create CSV and set headings</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="s1">&#39;wwn_data.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">),</span> <span class="s1">&#39;wt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
            <span class="n">eventwriter</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span>
                                     <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                                     <span class="n">quotechar</span><span class="o">=</span><span class="s1">&#39;|&#39;</span><span class="p">,</span>
                                     <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_MINIMAL</span><span class="p">)</span>

            <span class="n">eventwriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="s1">&#39;volumeId&#39;</span><span class="p">,</span> <span class="s1">&#39;effective_wwn&#39;</span><span class="p">,</span> <span class="s1">&#39;wwn&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;has_effective_wwn&#39;</span><span class="p">,</span> <span class="s1">&#39;storageGroupId&#39;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">device_id</span> <span class="ow">in</span> <span class="n">vol_list</span><span class="p">:</span>
            <span class="n">voldetails</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_volume</span><span class="p">(</span><span class="n">device_id</span><span class="p">)</span>
            <span class="n">effective_wwn</span> <span class="o">=</span> <span class="n">voldetails</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;effective_wwn&#39;</span><span class="p">)</span>
            <span class="n">wwn</span> <span class="o">=</span> <span class="n">voldetails</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;wwn&#39;</span><span class="p">)</span>
            <span class="n">has_effective_wwn</span> <span class="o">=</span> <span class="n">voldetails</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;has_effective_wwn&#39;</span><span class="p">)</span>
            <span class="n">storage_group_id</span> <span class="o">=</span> <span class="n">voldetails</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;storageGroupId&#39;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="s1">&#39;wwn_data.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">),</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
                <span class="n">eventwriter</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span>
                                         <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                                         <span class="n">quotechar</span><span class="o">=</span><span class="s1">&#39;|&#39;</span><span class="p">,</span>
                                         <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_MINIMAL</span><span class="p">)</span>
                <span class="n">eventwriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="n">device_id</span><span class="p">,</span> <span class="n">effective_wwn</span><span class="p">,</span> <span class="n">wwn</span><span class="p">,</span>
                                      <span class="n">has_effective_wwn</span><span class="p">,</span> <span class="n">storage_group_id</span><span class="p">])</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_vols_from_storagegroup"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_vols_from_storagegroup">[docs]</a>    <span class="k">def</span> <span class="nf">get_vols_from_storagegroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storagegroup_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve volume information associated with a particular sg.</span>

<span class="sd">        :param storagegroup_id: the name of the storage group</span>
<span class="sd">        :returns: list of device IDs of associated volumes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;storageGroupId&#39;</span><span class="p">:</span> <span class="n">storagegroup_id</span><span class="p">}</span>

        <span class="n">volume_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_volume_list</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">volume_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Cannot find record for storage group </span><span class="si">%(sg_id)s</span><span class="s1">.&#39;</span><span class="p">,</span>
                      <span class="p">{</span><span class="s1">&#39;sg_id&#39;</span><span class="p">:</span> <span class="n">storagegroup_id</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">volume_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_storagegroup_from_vol"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_storagegroup_from_vol">[docs]</a>    <span class="k">def</span> <span class="nf">get_storagegroup_from_vol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vol_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve sg information for a specified volume.</span>

<span class="sd">        :param vol_id: the device ID of the volume</span>
<span class="sd">        :returns: list of storage groups</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_volume</span><span class="p">(</span><span class="n">vol_id</span><span class="p">)</span>
        <span class="n">sg_list</span> <span class="o">=</span> <span class="n">vol</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;storageGroupId&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="k">if</span> <span class="n">vol</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">sg_list</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.is_volume_in_storagegroup"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.is_volume_in_storagegroup">[docs]</a>    <span class="k">def</span> <span class="nf">is_volume_in_storagegroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device_id</span><span class="p">,</span> <span class="n">storagegroup</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See if a volume is a member of the given storage group.</span>

<span class="sd">        :param device_id: the device id</span>
<span class="sd">        :param storagegroup: the storage group name</span>
<span class="sd">        :returns: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">is_vol_in_sg</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">sg_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_storagegroup_from_vol</span><span class="p">(</span><span class="n">device_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">storagegroup</span> <span class="ow">in</span> <span class="n">sg_list</span><span class="p">:</span>
            <span class="n">is_vol_in_sg</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">is_vol_in_sg</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.find_volume_device_id"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.find_volume_device_id">[docs]</a>    <span class="k">def</span> <span class="nf">find_volume_device_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">volume_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Given a volume identifier, find the corresponding device_id.</span>

<span class="sd">        :param volume_name: the volume name</span>
<span class="sd">        :returns: device_id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">device_id</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;volume_identifier&#39;</span><span class="p">:</span> <span class="n">volume_name</span><span class="p">}</span>

        <span class="n">volume_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_volume_list</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">volume_list</span><span class="p">:</span>
            <span class="n">LOG</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Cannot find record for volume </span><span class="si">%(volumeId)s</span><span class="s1">.&#39;</span><span class="p">,</span>
                      <span class="p">{</span><span class="s1">&#39;volumeId&#39;</span><span class="p">:</span> <span class="n">volume_name</span><span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">volume_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">device_id</span> <span class="o">=</span> <span class="n">volume_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">device_id</span> <span class="o">=</span> <span class="n">volume_list</span>
                <span class="n">LOG</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;volume name </span><span class="si">%(vol)s</span><span class="s1"> is not unique, returning &#39;</span>
                            <span class="s1">&#39;a list of device ids&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;vol&#39;</span><span class="p">:</span> <span class="n">volume_name</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">device_id</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.find_volume_identifier"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.find_volume_identifier">[docs]</a>    <span class="k">def</span> <span class="nf">find_volume_identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the volume identifier of a VMAX volume.</span>

<span class="sd">        :param device_id: the device id</span>
<span class="sd">        :returns: the volume identifier -- string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_volume</span><span class="p">(</span><span class="n">device_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">vol</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;volume_identifier&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">if</span> <span class="n">vol</span> <span class="k">else</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_size_of_device_on_array"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_size_of_device_on_array">[docs]</a>    <span class="k">def</span> <span class="nf">get_size_of_device_on_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the size of the volume from the array.</span>

<span class="sd">        :param device_id: the volume device id</span>
<span class="sd">        :returns: size</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_volume</span><span class="p">(</span><span class="n">device_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vol</span> <span class="ow">and</span> <span class="n">vol</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cap_gb&#39;</span><span class="p">):</span>
            <span class="n">cap</span> <span class="o">=</span> <span class="n">vol</span><span class="p">[</span><span class="s1">&#39;cap_gb&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">exception_message</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s1">&#39;Unable to retrieve size of device &#39;</span>
                <span class="s1">&#39;</span><span class="si">{device_id}</span><span class="s1"> on the array&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">device_id</span><span class="o">=</span><span class="n">device_id</span><span class="p">))</span>
            <span class="k">raise</span> <span class="n">exception</span><span class="o">.</span><span class="n">ResourceNotFoundException</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cap</span></div>

    <span class="k">def</span> <span class="nf">_modify_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modify a volume (PUT operation).</span>

<span class="sd">        :param device_id: volume device id</span>
<span class="sd">        :param payload: the request payload</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">,</span>
                                    <span class="n">payload</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">resource_name</span><span class="o">=</span><span class="n">device_id</span><span class="p">)</span>

<div class="viewcode-block" id="ProvisioningFunctions.extend_volume"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.extend_volume">[docs]</a>    <span class="k">def</span> <span class="nf">extend_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device_id</span><span class="p">,</span> <span class="n">new_size</span><span class="p">,</span> <span class="n">_async</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Extend a VMAX volume.</span>

<span class="sd">        :param device_id: volume device id</span>
<span class="sd">        :param new_size: the new required size for the device</span>
<span class="sd">        :param _async: flag to indicate if call should be async</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">extend_vol_payload</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;editVolumeActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;expandVolumeParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;volumeAttribute&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;volume_size&#39;</span><span class="p">:</span> <span class="n">new_size</span><span class="p">,</span>
                    <span class="s1">&#39;capacityUnit&#39;</span><span class="p">:</span> <span class="s1">&#39;GB&#39;</span><span class="p">}}}}</span>
        <span class="k">if</span> <span class="n">_async</span><span class="p">:</span>
            <span class="n">extend_vol_payload</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ASYNC_UPDATE</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modify_volume</span><span class="p">(</span><span class="n">device_id</span><span class="p">,</span> <span class="n">extend_vol_payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.rename_volume"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.rename_volume">[docs]</a>    <span class="k">def</span> <span class="nf">rename_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device_id</span><span class="p">,</span> <span class="n">new_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rename a volume.</span>

<span class="sd">        :param device_id: the volume device id</span>
<span class="sd">        :param new_name: the new name for the volume</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">new_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vol_identifier_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;identifier_name&#39;</span><span class="p">:</span> <span class="n">new_name</span><span class="p">,</span>
                <span class="s1">&#39;volumeIdentifierChoice&#39;</span><span class="p">:</span> <span class="s1">&#39;identifier_name&#39;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vol_identifier_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;volumeIdentifierChoice&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">}</span>
        <span class="n">rename_vol_payload</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;editVolumeActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;modifyVolumeIdentifierParam&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;volumeIdentifier&#39;</span><span class="p">:</span> <span class="n">vol_identifier_dict</span><span class="p">}}}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modify_volume</span><span class="p">(</span><span class="n">device_id</span><span class="p">,</span> <span class="n">rename_vol_payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.deallocate_volume"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.deallocate_volume">[docs]</a>    <span class="k">def</span> <span class="nf">deallocate_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deallocate all tracks on a volume.</span>

<span class="sd">        Necessary before deletion. Please note that it is not possible</span>
<span class="sd">        to know exactly when a deallocation is complete. This method</span>
<span class="sd">        will return when the array has accepted the request for deallocation;</span>
<span class="sd">        the deallocation itself happens as a background task on the array.</span>

<span class="sd">        :param device_id: the device id</span>
<span class="sd">        :returns: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;editVolumeActionParam&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;freeVolumeParam&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;free_volume&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span><span class="p">}}}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modify_volume</span><span class="p">(</span><span class="n">device_id</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.delete_volume"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.delete_volume">[docs]</a>    <span class="k">def</span> <span class="nf">delete_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete a volume.</span>

<span class="sd">        :param device_id: volume device id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">,</span> <span class="n">resource_name</span><span class="o">=</span><span class="n">device_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.find_low_volume_utilization"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.find_low_volume_utilization">[docs]</a>    <span class="k">def</span> <span class="nf">find_low_volume_utilization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">low_utilization_percentage</span><span class="p">,</span> <span class="n">csvname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Find volumes under a certain utilization threshold.</span>

<span class="sd">        Function to find volumes under a specified percentage,</span>
<span class="sd">        (e.g. find volumes with utilization less than 10%) - may be long</span>
<span class="sd">        running as will check all sg on array and all storage group.  Only</span>
<span class="sd">        identifies volumes in storage group,  note if volume is in more</span>
<span class="sd">        than one sg it may show up more than once.</span>

<span class="sd">        :param low_utilization_percentage: low utilization watermark percent</span>
<span class="sd">        :param csvname: filename for CFV output file</span>
<span class="sd">        :returns: will create csvfile with name passed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sg_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_storage_group_list</span><span class="p">()</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">csvname</span><span class="p">,</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
            <span class="n">eventwriter</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span>
                                     <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                                     <span class="n">quotechar</span><span class="o">=</span><span class="s1">&#39;|&#39;</span><span class="p">,</span>
                                     <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_MINIMAL</span><span class="p">)</span>

            <span class="n">eventwriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="s1">&#39;sgname&#39;</span><span class="p">,</span> <span class="s1">&#39;volumeid&#39;</span><span class="p">,</span> <span class="s1">&#39;identifier&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;capacity&#39;</span><span class="p">,</span> <span class="s1">&#39;allocated_Percent&#39;</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">sg</span> <span class="ow">in</span> <span class="n">sg_list</span><span class="p">:</span>
                <span class="n">vollist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_vols_from_storagegroup</span><span class="p">(</span><span class="n">sg</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">vol</span> <span class="ow">in</span> <span class="n">vollist</span><span class="p">:</span>
                    <span class="n">volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_volume</span><span class="p">(</span><span class="n">vol</span><span class="p">)</span>
                    <span class="n">vol_identifier</span> <span class="o">=</span> <span class="s1">&#39;No Identifier&#39;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">volume</span><span class="p">[</span><span class="s1">&#39;allocated_percent&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="p">(</span>
                            <span class="n">low_utilization_percentage</span><span class="p">)):</span>
                        <span class="n">allocated</span> <span class="o">=</span> <span class="n">volume</span><span class="p">[</span><span class="s1">&#39;allocated_percent&#39;</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">volume</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;volume_identifier&#39;</span><span class="p">):</span>
                            <span class="n">vol_identifier</span> <span class="o">=</span> <span class="p">(</span><span class="n">volume</span><span class="p">[</span><span class="s1">&#39;volume_identifier&#39;</span><span class="p">])</span>
                        <span class="n">vol_cap</span> <span class="o">=</span> <span class="p">(</span><span class="n">volume</span><span class="p">[</span><span class="s1">&#39;cap_gb&#39;</span><span class="p">])</span>
                        <span class="n">eventwriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span>
                            <span class="p">[</span><span class="n">sg</span><span class="p">,</span> <span class="n">vol</span><span class="p">,</span> <span class="n">vol_identifier</span><span class="p">,</span> <span class="n">vol_cap</span><span class="p">,</span> <span class="n">allocated</span><span class="p">])</span></div>

<div class="viewcode-block" id="ProvisioningFunctions.get_workload_settings"><a class="viewcode-back" href="../../source/PyU4V.html#PyU4V.provisioning.ProvisioningFunctions.get_workload_settings">[docs]</a>    <span class="k">def</span> <span class="nf">get_workload_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get valid workload options from array.</span>

<span class="sd">        :returns: workload_setting -- list of workload names</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wl_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_id</span><span class="p">,</span> <span class="n">SLOPROVISIONING</span><span class="p">,</span> <span class="s1">&#39;workloadtype&#39;</span><span class="p">)</span>
        <span class="n">wl_setting</span> <span class="o">=</span> <span class="n">wl_details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;workloadId&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="k">if</span> <span class="n">wl_details</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">wl_setting</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Ciara Stacke

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>